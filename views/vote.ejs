<!DOCTYPE html>
<html>
<head>
    <title>Vote for Books</title>
    <style>
        body {
            background-color: #1a1a1a;
            color: #ddd;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            text-align: center;
        }
        h1 {
            color: #9b59b6;
            margin-bottom: 20px;
        }
        .books-container {
            display: flex;
            flex-direction: column;
            max-height: 80vh;
            overflow-y: auto;
            gap: 15px;
            padding: 10px;
            margin: 0 auto;
            width: 90%;
            border: 1px solid #444;
            border-radius: 10px;
            background-color: #2c2c2c;
        }
        .book {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 10px;
            border-bottom: 1px solid #444;
        }
        .book img {
            width: 120px;
            height: 180px;
            object-fit: cover;
            border-radius: 5px;
        }
        .book div {
            text-align: left;
        }
        select {
            padding: 5px;
            border-radius: 5px;
            border: none;
            background-color: #444;
            color: #fff;
        }
        button {
            margin-top: 15px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #9b59b6;
            color: #fff;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background-color: #7a3490;
        }
    </style>
</head>
<body>
    <h1>Vote for Your Top 3 Books</h1>
    <form action="/vote" method="POST" id="voteForm">
        <div class="books-container">
            <% books.forEach((book) => { %>
                <div class="book">
                    <img src="<%= book.cover %>" alt="<%= book.title %>">
                    <div>
                        <p><b><%= book.title %></b></p>
                        <p><%= book.author %></p>
                    </div>
                    <select name="<%= book.title %>">
                        <option value="">--Select Points--</option>
                        <option value="3">3</option>
                        <option value="2">2</option>
                        <option value="1">1</option>
                    </select>
                </div>
            <% }) %>
        </div>
        <button type="submit">Submit Vote</button>
    </form>



    <script>
        const form = document.getElementById('voteForm');
        form.addEventListener('submit', (e) => {
            const selected = Array.from(form.querySelectorAll('select'))
                                  .map(s => s.value)
                                  .filter(v => v !== '');
            const counts = { '3':0, '2':0, '1':0 };
            selected.forEach(v => counts[v]++);
            if (counts['3'] !== 1 || counts['2'] !== 1 || counts['1'] !== 1) {
                e.preventDefault();
                alert("You must assign 3, 2, and 1 points exactly once each to three different books.");
            }
        });
    </script>
</body>
</html>
